<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <title>AlphaBoss - Gameplay</title>
    <link rel="stylesheet" href="gameplay.css">
</head>
<body>
    <!-- Elements for the background cursor effect -->
    <div id="blob"></div>
    <div id="blur"></div>

    <main class="screen">
        <!-- Round Information -->
        <section class="round-info">
            <div class="boss">
                <div class="boss-portrait" aria-label="Boss portrait">
                    <div class="googly-eyes">
                        <div class="eye">
                            <div class="pupil"></div>
                        </div>
                        <div class="eye">
                            <div class="pupil"></div>
                        </div>
                    </div>
                </div>
                <div class="boss-dialog" aria-live="polite">
                    <div class="dialog-multi">
                        <span class="dialog-line">{Boss flavor text}</span>
                    </div>
                </div>
                <div class="round-indicator">
                    <div class="round-label">ROUND</div>
                    <div class="round-value" id="roundValue">1</div>
                </div>
            </div>
            <div class="scores">
                <div class="round-score">
                    <div class="score-label">ROUND SCORE</div>
                    <div class="score-value" id="roundScore">50</div>
                </div>
                <div class="progress">
                    <div class="bar"><span id="progressBar"></span></div>
                </div>
                <div class="target">
                    <div class="target-label">SCORE AT LEAST</div>
                    <div class="target-value" id="targetScore">450</div>
                </div>
            </div>
        </section>

        <!-- Player Info & Items -->
        <section class="player-strip">
            <div class="pill">
                <div class="pill-label">WORDS</div>
                <div class="pill-value" id="wordsRemaining">5</div>
            </div>
            <div class="pill">
                <div class="pill-label">DISCARDS</div>
                <div class="pill-value" id="discards">5</div>
            </div>
            <div class="pill">
                <div class="pill-label">MONEY</div>
                <div class="pill-value money" id="money">$4</div>
            </div>
        </section>

        <section class="item-tabs">
            <button class="tab" aria-pressed="true">PERKS</button>
            <button class="tab">CONSUMABLES</button>
        </section>

        <!-- Scoring Area -->
        <section class="scoring">
            <div class="chips" id="scoreChips">
                <!-- Chips will be dynamically added here -->
            </div>
            <!-- New Score Calculation Breakdown -->
            <div class="score-calculation">
                <div class="calc-box value-box">
                    <span class="calc-value" id="calcValue">0</span>
                </div>
                <span class="calc-operator">×</span>
                <div class="calc-box mult-box">
                    <span class="calc-value" id="calcMult">1.0x</span>
                </div>
                <span class="calc-operator">×</span>
                <div class="calc-box mult-mult-box">
                    <span class="calc-value" id="calcMultMult">1.0x</span>
                </div>
                <span class="calc-operator">=</span>
                <div class="calc-total" id="calcTotal">0</div>
            </div>
        </section>

        <!-- Playable Grid -->
        <section class="grid" id="tileGrid" aria-label="Letter grid">
            <!-- 16 tiles generated by JS -->
        </section>

        <!-- Actions -->
        <section class="actions">
            <button class="btn btn-clear" id="btnClear">CLEAR</button>
            <button class="btn btn-secondary" id="btnOptions">OPTIONS</button>
            <button class="btn btn-secondary" id="btnBag">BAG</button>
            <button class="btn btn-play" id="btnPlay">PLAY</button>
        </section>
    </main>

    <div class="modal-overlay" id="bagModalOverlay">
      <div class="bag-modal">
        <button class="btn-close" id="btnCloseBagModal" aria-label="Close bag view">&times;</button>
        <h2 class="bag-title">BAG</h2>
        <div class="bag-info">
            <span id="tilesRemainingInfo">Tiles remaining: 0</span>
        </div>
        <div class="sort-container">
          <span class="sort-label">SORT</span>
          <div class="sort-controls">
            <button class="sort-btn active" id="sortAZ" data-sort="alpha">A-Z</button>
            <button class="sort-btn" id="sortType" data-sort="type">TYPE</button>
            <button class="sort-btn" id="sortValue" data-sort="value">VALUE</button>
          </div>
        </div>
        <div class="bag-grid-container">
            <div class="bag-grid" id="bagGrid">
                </div>
        </div>
      </div>
    </div>

    <div class="modal-overlay" id="victoryModalOverlay">
        <div class="victory-modal">
            <h2 class="victory-title">VICTORY</h2>
            <!-- This row is for flavor text, can be populated later -->
            <div class="victory-row flavor-text">
                <div class="victory-icon boss-icon"></div>
                <div class="victory-text-box">
                    <span>You won! Here are your spoils...</span>
                </div>
            </div>
            <div class="victory-calculations">
                <!-- This row calculates bonus for beating the boss -->
                <div class="victory-row" id="victoryBossRow">
                    <span class="victory-label-num">1</span>
                    <span class="victory-label">BOSS BEATEN</span>
                    <span class="victory-value money" id="victoryBossValue"></span>
                </div>
                <!-- This row calculates bonus for words remaining -->
                <div class="victory-row" id="victoryWordsRow">
                    <span class="victory-label-num" id="victoryWordsCount"></span>
                    <span class="victory-label">WORDS REMAINING ($2 EACH)</span>
                    <span class="victory-value money" id="victoryWordsValue"></span>
                </div>
            </div>
            <div class="victory-divider"></div>
            <button class="victory-cashout-btn" id="victoryCashOutBtn">CASH OUT: $0</button>
        </div>
    </div>

    <div class="modal-overlay" id="defeatModalOverlay">
        <div class="defeat-modal">
            <h2 class="defeat-title">GAME OVER :(</h2>
            <div class="defeat-stats">
                <div class="defeat-stat-row">
                    <span class="defeat-label">Best word</span>
                    <div class="defeat-value-box"><span id="defeatBestWord">N/A</span></div>
                </div>
                <div class="defeat-stat-row">
                    <span class="defeat-label">Words played</span>
                    <div class="defeat-value-box"><span id="defeatWordsPlayed">0</span></div>
                </div>
                <div class="defeat-stat-row">
                    <span class="defeat-label">Round</span>
                    <div class="defeat-value-box"><span id="defeatRound">1</span></div>
                </div>
                <div class="defeat-stat-row">
                    <span class="defeat-label">Defeated by</span>
                    <div class="defeat-value-box"><span id="defeatReason">Out of words</span></div>
                </div>
            </div>
            <div class="defeat-divider"></div>
            <div class="defeat-actions">
                <button class="btn-new-run" id="defeatNewRun">NEW RUN</button>
                <button class="btn-main-menu" id="defeatMainMenu">MAIN MENU</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="howToPlayModalOverlay">
        <div class="how-to-play-modal">
            <div class="how-to-play-content">
                <h2 class="how-to-play-title">HOW TO PLAY</h2>
                <ul class="how-to-play-list">
                    <li>1. SPELL WORDS BY TAPPING TILES. BIGGER WORDS = MORE POINTS</li>
                    <li>2. BEAT THE SCORE TO WIN THE ROUND</li>
                    <li>3. SURVIVE AS MANY ROUNDS AS POSSIBLE</li>
                </ul>
            </div>
            <button class="how-to-play-btn" id="howToPlayGotIt">GOT IT!</button>
        </div>
    </div>

    <div id="devPanel" class="dev-panel">
        <div class="dev-panel-header">
            <h3 class="dev-title">DEV CONTROLS</h3>
            <button id="devMinimizeBtn" class="dev-minimize-btn">-</button>
        </div>
        <div class="dev-panel-content">
            <button id="devRefresh">Refresh Board</button>
            <button id="devWin">Auto Win Round</button>
            <button id="devLose">Auto Lose Round</button>
            <div class="dev-score-calc">
                <h4 class="dev-subtitle">Score Breakdown</h4>
                <div id="devScoreDetails">Select tiles...</div>
            </div>
            <h4 class="dev-subtitle">Navigation</h4>
            <button id="devNavMenu">Main Menu</button>
            <button id="devNavGame">Gameplay</button>
            <button id="devNavShop">Shop</button>
            <button id="devNavEvent">Event</button>
        </div>
    </div>

    <!-- Tooltip Element (initially hidden) -->
    <div class="tile-tooltip" id="tileTooltip">
        <div class="tooltip-tile">
            <div class="tooltip-letter">T</div>
            <div class="tooltip-value">1</div>
        </div>
        <div class="tooltip-info">
            <!-- Populated by JS -->
        </div>
    </div>


    <!-- Sound library and manager -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
    <script src="sound.js"></script>
    <script src="gameplay.js"></script>
</body>
</html>
